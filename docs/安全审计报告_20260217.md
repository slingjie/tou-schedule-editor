# ğŸ”’ å®‰å…¨å®¡è®¡æŠ¥å‘Š

**æ—¥æœŸ**: 2026-02-17  
**å®¡è®¡èŒƒå›´**: å…¨æ ˆï¼ˆPython åç«¯ + Cloudflare Functions + å‰ç«¯ + éƒ¨ç½²è„šæœ¬ï¼‰

---

## ä¿®å¤æ¸…å•

| ç¼–å· | çº§åˆ« | æè¿° | çŠ¶æ€ |
|---|---|---|---|
| #1 | P0 | GEMINI API Key æ³„éœ²åˆ°å‰ç«¯ JS åŒ… | âœ… å·²ä¿®å¤ |
| #2 | P0 | Cloudflare Sync API æ— é‰´æƒ | âœ… å·²ä¿®å¤ |
| #3 | P0 | 6ä¸ªæ–‡ä»¶ç»‘å®š `0.0.0.0` | âœ… å·²ä¿®å¤ |
| #4 | P1 | åç«¯ API æ— é‰´æƒ | âš ï¸ ç»‘å®š 127.0.0.1 åé£é™©å¯æ§ |
| #5 | P1 | CORS `allow_origins=["*"]` | âš ï¸ ç”Ÿäº§éƒ¨ç½²æ—¶éœ€æ”¶çª„ |
| #6 | P2 | Debug ç«¯ç‚¹æš´éœ²å†…éƒ¨ä¿¡æ¯ | âœ… å·²ä¿®å¤ |
| #7 | P2 | `wrangler.toml` ç¡¬ç¼–ç  Database ID | âš ï¸ å»ºè®®åç»­æ”¹ç”¨ç¯å¢ƒå˜é‡ |
| #8 | P2 | `/outputs` ç›®å½•å¯éå† | âš ï¸ ç»‘å®š 127.0.0.1 åé£é™©å¯æ§ |

## å·²å®Œæˆä¿®å¤çš„æ–‡ä»¶

### P0 #1ï¼šAPI Key æ³„éœ²
- `vite.config.ts` â€” ç§»é™¤ `define` ä¸­çš„ `process.env.API_KEY` å’Œ `process.env.GEMINI_API_KEY`

### P0 #2ï¼šSync API é‰´æƒ
- `functions/api/sync/_auth.js` â€” **æ–°å¢** é‰´æƒä¸­é—´ä»¶
- `functions/api/sync/push.js` â€” å¢åŠ é‰´æƒæ£€æŸ¥
- `functions/api/sync/pull.js` â€” å¢åŠ é‰´æƒæ£€æŸ¥
- `functions/api/sync/register.js` â€” å¢åŠ é‰´æƒæ£€æŸ¥
- `functions/api/sync/upload.js` â€” å¢åŠ é‰´æƒæ£€æŸ¥
- `functions/api/sync/download/[[key]].js` â€” å¢åŠ é‰´æƒæ£€æŸ¥
- `cloudSyncApi.ts` â€” å‰ç«¯è‡ªåŠ¨ä» `localStorage` è¯»å– `SYNC_API_KEY` å¹¶é™„åŠ åˆ°è¯·æ±‚
- `wrangler.toml` â€” æ·»åŠ  `SYNC_API_KEY` é…ç½®è¯´æ˜

**ä½¿ç”¨æ–¹æ³•**ï¼š
1. åœ¨ Cloudflare Dashboard â†’ Pages â†’ Settings â†’ Environment variables è®¾ç½® `SYNC_API_KEY`
2. åœ¨å‰ç«¯ localStorage ä¸­è®¾ç½®ï¼š`localStorage.setItem('SYNC_API_KEY', 'ä½ çš„å¯†é’¥')`

### P0 #3ï¼š`0.0.0.0` â†’ `127.0.0.1`
- `vite.config.ts` â€” å‰ç«¯ Vite å¼€å‘æœåŠ¡å™¨
- `start-backend.sh` â€” åç«¯å¯åŠ¨è„šæœ¬
- `start-services.bat` â€” Windows BAT å¯åŠ¨è„šæœ¬ï¼ˆ2å¤„ï¼‰
- `start-services.ps1` â€” Windows PowerShell å¯åŠ¨è„šæœ¬
- `deploy-windows.ps1` â€” Windows éƒ¨ç½²è„šæœ¬

> æ³¨ï¼š`Dockerfile`ã€`render.yaml`ã€`deploy-backend.sh` ä¸­çš„ `0.0.0.0` ä¸ºå®¹å™¨/PaaS ç¯å¢ƒæ­£ç¡®é…ç½®ï¼Œæœªä¿®æ”¹ã€‚

### P2 #6ï¼šDebug ç«¯ç‚¹
- `backend/app.py` â€” `/api/debug/runtime` ç°åœ¨éœ€è¦ `DEBUG_MODE=1` ç¯å¢ƒå˜é‡æ‰å¯è®¿é—®
